<!DOCTYPE html>
<html>

<head>
   <title>Trade</title>
   <link href="css/font-awesome.min.css" rel="stylesheet">
   <link href="css/bootstrap.css" rel="stylesheet">
   <script src="js/jquery.min.js"></script>
   <script src="js/bootstrap.min.js"></script>
   <link rel="stylesheet" type="text/css" href="css/w2ui.min.css" />
   <script type="text/javascript" src="js/w2ui.min.js"></script>
   <script type="text/javascript" src="js/dialog.js"></script>
   <style>
      #depthEFP {
         visibility: hidden;
         width: 20px;
         display: none;
      }
      #depthEFPTranspose {
         visibility: visible;
      }
      .tab {
         position: absolute;
         top: 29px;
         left: 0px;
         bottom: 0px;
         right: 0px;
         border: none;
         border-top: 0px;
         display: none;
         padding: 0px;
         overflow: hidden;
         background-color: #F5F6F7;
      }
   </style>
   <script>
      var counter = setInterval(transposeDepth, 1000);


function extractParameter(name) {
	var source = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
	var expression = "[\\?&]"+source+"=([^&#]*)";
	var regex = new RegExp(expression);
	var results = regex.exec(window.location.href);
	
	if( results == null ) {
		return "";
	}  
	return results[1];
}

      function transposeDepth() {
         var table = document.getElementById("depthEFP");
         var height = table.rows.length;
         var depth = [];

         for (var i = 0; i < height; i++) {
            var width = table.rows[0].cells.length;

            for (var j = 0; j < 10; j++) {
               var level = {};

			   level['product'] = document.getElementById("depthEFP_product_" + i).innerHTML;
               level['bidPrice'] = document.getElementById("depthEFP_bidPrice" + j + "_" + i).innerHTML;
               level['offerPrice'] = document.getElementById("depthEFP_offerPrice" + j + "_" + i).innerHTML;
               level['bidVolume'] = document.getElementById("depthEFP_bidVolume" + j + "_" + i).innerHTML;
               level['offerVolume'] = document.getElementById("depthEFP_offerVolume" + j + "_" + i).innerHTML;
               level['bidCompany'] = document.getElementById("depthEFP_bidCompany" + j + "_" + i).innerHTML;
               level['offerCompany'] = document.getElementById("depthEFP_offerCompany" + j + "_" + i).innerHTML;

               depth[j] = level;
            }
         }
         var transpose = document.getElementById("depthEFPTranspose");
         var actual = transpose.rows.length;
         var required = depth.length;

         if (required > actual) {
            for (var i = actual; i <= required; i++) {
               transpose.insertRow(i);

               for (var j = 0; j < 4; j++) {
                  transpose.rows[i].insertCell(j);
               }
            }
         }
         var side = extractParameter("side");
         
         for (var i = 0; i < depth.length; i++) {         	
         	if(side == "bid") {
         		var company = depth[i].bidCompany;
         		var length = company.length;
         		
         		transpose.rows[i].cells[0].style.cssText = "height: 40px;";    
         		
         		if(length > 0) {     	
            		transpose.rows[i].cells[0].innerHTML = "<input type='checkbox'/>";            	
            		transpose.rows[i].cells[1].innerHTML = "<b>" + depth[i].bidPrice + "bp</b>";         
            		transpose.rows[i].cells[2].innerHTML = "<img src='img/" + depth[i].bidCompany + ".png'/>";
            		transpose.rows[i].cells[3].innerHTML = "Up to $" + depth[i].bidVolume + "mil";
            	} else {
            		transpose.rows[i].cells[0].innerHTML = "";
            		transpose.rows[i].cells[1].innerHTML = "";
            		transpose.rows[i].cells[2].innerHTML = "";
            		transpose.rows[i].cells[3].innerHTML = "";            		            		            		
            	}
            } else {
         		var company = depth[i].offerCompany;
         		var length = company.length;
         		
         		transpose.rows[i].cells[0].style.cssText = "height: 40px;";    
         		
         		if(length > 0) {              
					transpose.rows[i].cells[0].style.cssText = "height: 40px;";               
            		transpose.rows[i].cells[0].innerHTML = "<input type='checkbox'/>";               
            		transpose.rows[i].cells[1].innerHTML = "<b>" + depth[i].offerPrice + "bp</b>";         
            		transpose.rows[i].cells[2].innerHTML = "<img src='img/" + depth[i].offerCompany + ".png'/>";
            		transpose.rows[i].cells[3].innerHTML = "Up to $" + depth[i].offerVolume + "mil";
            	} else {
            		transpose.rows[i].cells[0].innerHTML = "";
            		transpose.rows[i].cells[1].innerHTML = "";
            		transpose.rows[i].cells[2].innerHTML = "";
            		transpose.rows[i].cells[3].innerHTML = "";            		            		            		
            	}            		            
            }
         }
      }
   </script>
</head>

<body style="height: 100%; margin: 0; background-color: #ff0000;">

   <body>
      <div id="tab-example">
         <div id="tabs" style="height: 29px;"></div>
         <div id="tab1" class="tab">
         
            <table border="1" width="100%">
               <tr>
               	<td width="10%">XXX</td>
               	<td width="90%">YYY</td>                 	               
               </tr>               
           </table>         
         
            <table border="1" width="100%">
               <tr height='100%'>
                  <td colspan="3">
                     <table border="1" width="100%">
                        <tr align="center">
                           <td>
                              <table id="depthEFPTranspose" cellpadding="5"/>
                              <table id="depthEFP" />
                           </td>
                        </tr>
                     </table>
                  </td>
               </tr>               
           </table>
           <table border="1" style="width: 100%; height: 60px;">
               <tr>
                  <td></td>
                  <td align="right"><button class="btn">Cancel</button></td>
                  <td></td>
               </tr>
            </table>
         </div>
         <div id="tab2" class="tab">
            <table border='1' height="100%">
               <tr>
                  <td>Hi</td>
               </tr>
            </table>
         </div>
         <div id="tab3" class="tab">
            <table border='1' height="100%">
               <tr>
                  <td>Hi</td>
               </tr>
            </table>
         </div>
         <div id="tab4" class="tab">
            <table border='1' height="100%">
               <tr>
                  <td>Hi</td>
               </tr>
            </table>
         </div>
      </div>
      <script type="text/javascript">
         var config = {
            tabs: {
               name: 'tabs',
               active: 'tab1',
               tabs: [{
                  id: 'tab1',
                  caption: 'Trade Request'
               }, {
                  id: 'tab2',
                  caption: 'Quote Request'
               }, {
                  id: 'tab3',
                  caption: 'My Allocations'
               }, {
                  id: 'tab4',
                  caption: 'Ticketing'
               }, ],
               onClick: function(event) {
                  $('#tab-example .tab').hide();
                  $('#tab-example #' + event.target).show();
               }
            }
         }
         $(function() {
            $('#tabs').w2tabs(config.tabs);
            $('#tab1').show();
         });
      </script>

   </body>

</html>
